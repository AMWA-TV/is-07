# Event types

This document specifies the base supported event types and the strategies employed to define derived types.

There are two main categories for event types:

* base event types
* derived event types

## 1. Base event types

The base event types are the core building blocks for other events but can also be used for simple states.

The base event type categories are:

* boolean
* string
* number

### 1.1 boolean

The boolean event type will have a `"value"` boolean field.

```json
{
    "value": true
}
```

Examples:  
A switch on position condition is either true or false  
A simple button pressed condition is either true or false

### 1.2 string

The string event type will have a `"value"` string field.

```json
{
    "value": "my label"
}
```

Examples:  
A simple label on a button or on another UI element.

### 1.3 number

The number event type will have a `"value"` number field. Number in JSON can be either integer or floating point.

integer

```json
{
    "value": 20
}
```

floating point

```json
{
    "value": 1.0
}
```

## 2. Derived event types

Derived event types cannot exist without a custom schema being defined. That's to say that `string/enum` cannot exist as an event type because it cannot refer to a specific schema whereas `string/enum/SimpleAlarm` is a valid derived event type example.

The derived event type categories are:

* string/enum/{Name}
* number/enum/{Name}
* number/range/{Name}
* number/measurement/{Name}
* number/range/measurement/{Name}
* custom

where `Name` is the name of the derived type

The schema url will be provided in a senders' `manifest_href` field. Each sender device is responsible for hosting the schemas for the associated event types it can emmit.

Example of sender:

```json
{
    "tags": {},
    "interface_bindings": [
        "eth0"
    ],
    "subscription": {
        "receiver_id": null,
        "active": false
    },
    "description": "Virtual Button 1",
    "transport": "urn:x-nmos:transport:mqtt",
    "label": "Virtual Button 1",
    "id": "68f519a3-5523-4b2c-b72d-ec23cc80207d",
    "device_id": "58f6b536-ca4c-43fd-880a-9df2501fc125",
    "flow_id": "0554b43a-ea7c-418d-a39e-1205ee281af3",
    "manifest_href": "http://hostname/x-nmos/events/v1.0/schemas/boolean",
    "version": "1529676926:000000000"
}
```

### 2.1 string/enum/{Name}

Will have a `"value"` string field describing the current value.

An associated schema needs to have the following:

* restriction on the value data type to string
* indicate all the possible options
* mandatory label for each possible value (can be the same as the value or different)
* optional associated descriptions for each possible value

Example:  

```json
{
    "value": "fail"
}
```

Possible options

```json
[
    "unknown"
    "ok",
    "warning",
    "fail"
]
```

Example name: `string/enum/SimpleAlarm`

### 2.2 number/enum/{Name}

Will have a `"value"` number field describing the current value.

An associated schema needs to have the following:

* restriction on the value data type to number
* indicate all the possible options
* mandatory label for each possible value
* optional associated descriptions for each possible value

Example:  

```json
{
    "value": 0
}
```

Possible options

```json
[
    0,
    1,
    2,
    3
]
```

Example name: `number/enum/SimpleAlarm`

### 2.3 number/range/{Name}

Will have a `"value"` number field describing the current value.

An associated schema needs to have the following:

* restriction on the value data type to number
* indicate min, max, step

Example:  

```json
{
    "value": 0
}
```

Example name: `number/range/DeviceCount`

### 2.4 number/measurement/{Name}

Will have a `"value"` number field describing the current value.

An associated schema needs to have the following:

* restriction on the value data type to number
* string `"unit"` field specifying the measurement unit

Example:  

```json
{
    "value": 22
}
```

Example name: `number/range/Temperature`

### 2.5 number/range/measurement/{Name}

Will have a `"value"` number field describing the current value.

An associated schema needs to have the following:

* restriction on the value data type to number
* string `"unit"` field specifying the measurement unit
* indicate min, max, step

Example:  

```json
{
    "value": 22
}
```

Example name: `number/range/measurement/Temperature`

### 2.6 Custom

Custom event types are complex and need a custom schema which defines it. They can have a combination of base types and other derived types.

It is important to only use the custom event type if all other options have been exhausted (the state we wish to send cannot possible fit in any of the above types). It may be that splitting the complex state into simpler states allows us to send them invididually as simpler types.

## Event types capability management

Flow `"event_type"` fields always need to have an exact specific event type.

Receivers `"event_types"` field can have a specific event type or may have a derived partial event type using a wildcard (`*`).

More details about NMOS resources in the section [Core models](3.0 Core_models.md).

Using the wildcard allows a smart receiver to advertise a wider capability with a specific category above. This is useful information when building a user interface which handles connection management but also matches capabilities between senders and receivers.

An example of a receiver which may use a wildcard could be a smart software gauge which can autocalibrate. This could advertise its capability as `number/measurement/*`.

![Event types capability management](images/event-types-capability-management.png)
